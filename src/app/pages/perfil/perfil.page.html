<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>Mi Perfil</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <div *ngIf="loading" class="loading-container">
    <ion-spinner></ion-spinner>
  </div>

  <div *ngIf="!loading && perfil" class="perfil-container">
    <div class="avatar-section">
      <ion-icon name="person-circle-outline" class="avatar-icon"></ion-icon>
      <h2>{{ perfil.nombre }}</h2>
      <ion-chip [color]="getRolColor(perfil.rol)">
        <ion-label>{{ getRolLabel(perfil.rol) }}</ion-label>
      </ion-chip>
    </div>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Información Personal</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <form [formGroup]="perfilForm">
          <ion-item>
            <ion-icon name="person-circle-outline" slot="start"></ion-icon>
            <ion-label position="floating">Nombre</ion-label>
            <ion-input type="text" formControlName="nombre"></ion-input>
          </ion-item>

          <ion-item>
            <ion-icon name="call-outline" slot="start"></ion-icon>
            <ion-label position="floating">Teléfono</ion-label>
            <ion-input type="tel" formControlName="telefono" placeholder="1234567890"></ion-input>
          </ion-item>

          <div class="button-group">
            <ion-button 
              *ngIf="!editMode" 
              expand="block" 
              (click)="toggleEditMode()">
              Editar Perfil
            </ion-button>

            <div *ngIf="editMode" class="edit-buttons">
              <ion-button 
                expand="block" 
                (click)="guardarCambios()"
                [disabled]="!perfilForm.valid">
                <ion-icon name="save-outline" slot="start"></ion-icon>
                Guardar
              </ion-button>
              <ion-button 
                expand="block" 
                fill="outline"
                (click)="toggleEditMode()">
                Cancelar
              </ion-button>
            </div>
          </div>
        </form>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Información de Cuenta</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="info-item">
          <strong>ID de usuario:</strong>
          <span class="user-id">{{ perfil.id }}</span>
        </div>
      </ion-card-content>
    </ion-card>

    <ion-button 
      expand="block" 
      color="danger" 
      (click)="confirmarCerrarSesion()"
      class="logout-button">
      <ion-icon name="log-out-outline" slot="start"></ion-icon>
      Cerrar Sesión
    </ion-button>
  </div>
</ion-content>
